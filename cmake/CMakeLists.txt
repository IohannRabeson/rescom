function(rescom_compile TARGET_NAME RESCOM_FILE)
    # rescom.hpp is the file generated by Rescom
    target_sources(${TARGET_NAME} PRIVATE ${CMAKE_CURRENT_BINARY_DIR}/rescom.hpp)

    set(RECURSIVE_FLAG "")
    if ("RECURSIVE" IN_LIST ARGV)
        set(RECURSIVE_FLAG "-r")
    endif()
    add_custom_command(
        COMMAND rescom ${RECURSIVE_FLAG} -i ${RESCOM_FILE} -o ${CMAKE_CURRENT_BINARY_DIR}/rescom.hpp
        DEPENDS ${RESCOM_FILE} rescom
        OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/rescom.hpp
        COMMENT "Running Rescom..."
    )

    target_include_directories(${TARGET_NAME} PRIVATE ${CMAKE_CURRENT_BINARY_DIR})
    set_target_properties(${TARGET_NAME} PROPERTIES CXX_STANDARD 17)
endfunction()